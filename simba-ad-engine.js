simbaAdEngine=function(e,t){function a(){e("div[simba-deals]").each(function(){var t=e(this).attr("simba-deals");var n=this;s(t,function(t,r){var i=e(n).attr("simba-type");if(i){i=i.toUpperCase();if(i=="BIG_BOX"){o(n,t,r)}if(i=="LEADER"){u(n,t,r)}}})});i()}Number.prototype.currencyFormat=function(e,t){var n="\\d(?=(\\d{"+(t||3)+"})+"+(e>0?"\\.":"$")+")";return this.toFixed(Math.max(0,~~e)).replace(new RegExp(n,"g"),"$&,")};String.prototype.truncate=function(t){if(String.length>=t)return this;return this.length>t?e.trim(this).substring(0,t).split(" ").slice(0,-1).join(" ")+"...":this};var n=[{code:"SOME_AD_CODE",categoryId:"34635776",productCount:5}];var r=function(t,n){var r=e.grep(t,function(e){return e.id==n});var r=r[0];return r};var i=function(){e("img.simbaAdImage").each(function(t,n){var r=e(n).height();var i=e(n).parent().height();if(r<i){var s=(i-r)/2+"px";e(n).css({"margin-top":s})}else if(r>i){e(n).css({width:"auto",height:"100%"});var o=e(n).width();var u=e(n).parent().width();var s=(u-o)/2+"px";e(n).css({"margin-left":s})}})};var s=function(t,r){var i=e.grep(n,function(e){return e.code==t});i=i[0];var s=function(t){var n="http://shop.monetizer101.com/shop-rest/api/v2.0/shop/2/widget/category?isoCurrencyCode=CAD&categoryId="+t.categoryId+"&productLimit="+t.productCount;e.ajax({url:n,type:"GET",dataType:"json",retryLimit:3,contentType:"application/json; charset=utf-8",statusCode:{200:function(e){o(e,r)}}})};var o=function(t,n){var r="http://shop.monetizer101.com/shop-rest/api/v2.0/shop/2/merchant/list?isoCurrencyCode=CAD";e.ajax({url:r,type:"GET",dataType:"json",retryLimit:3,contentType:"application/json; charset=utf-8",statusCode:{200:function(e){n(e,t)}}})};s(i)};var o=function(n,i,s){var o=s[1];var u=r(i,o.merchantId);var a=t.template('<div class="productContainer"><img class="simbaAdImage" src="<%= src %>" alt="<%= alt %>" /></div>',{src:o.imageURL,alt:o.name});var f=t.template('<span class="brand"><%= merchant %></span>'+'<span class="description"><%= description %></span>'+'<span class="price">$<%= price %></span><span class="priceTag">&nbsp;</span><span class="link">Hurry & Save!</span>',{merchant:u.name,description:o.name.truncate(50),price:parseInt(o.salePrice).currencyFormat(2)});var l=t.template('<div class="simbaBigBox">'+'<div class="smHeader"></div>'+'<div class="smBody">'+'<div class="smArrow"></div>'+"<%= bodyImg %>"+'<div class="meta"><div class="meta-inner"><%= metaData %></div>'+'<div class="nav" simba-position="1"><img src="/adgroups/bigbox/prev-btn.png" class="prev" /><img src="/adgroups/bigbox/next-btn.png" class="next" /></div>'+"</div></div>"+'<div class="smFooter"></div>',{bodyImg:a,metaData:f});e(n).attr("data-url",o.deepLink);e(n).append(l,null);e(n).find(".productContainer, .meta-inner").click(function(){var t=e(n).attr("data-url");location.href=t});var c=e(".simbaBigBox").find(".prev, .next");var h=function(){var t=e(this).parent();var n=parseInt(e(t).attr("simba-position"));if(e(this).hasClass("next")){n++;if(n==s.length){n=0}}if(e(this).hasClass("prev")){n--;if(n==-1){n=s.length-1}}var r=s[n];var i=e(this).parent().parent();var o=e(i).parent().find(".simbaAdImage")[0];e(o).attr("src",r.imageURL);e(o).attr("alt",r.name);e(e(i).find(".brand")[0]).text(u.name);e(e(i).find(".description")[0]).text(r.name.truncate(50));e(e(i).find(".price")[0]).text("$"+parseFloat(r.salePrice).currencyFormat(2));e(i).parent().parent().parent().attr("data-url",r.deepLink);e(t).attr("simba-position",n)};e(c).click(h);setInterval(function(){e(n).find(".next").trigger("click")},4500)};var u=function(n,i,s){var o=s[0];var u=r(i,o.merchantId);var a=t.template('<div class="productContainer"><img class="simbaAdImage" src="<%= src %>" alt="<%= alt %>" /></div>',{src:o.imageURL,alt:o.name});var f=t.template('<span class="brand"><%= merchant %></span>'+'<span class="description"><%= description %></span>'+'<span class="price">$<%= price %></span><span class="priceTag">&nbsp;</span><span class="link">Hurry & Save!</span>',{merchant:u.name,description:o.name.truncate(40),price:o.salePrice});var l=function(e,n){var r="";for(var i=0;i<e.length;i++){if(n!=i){var s=e[i];var o=t.template('<div class="backProduct" data-ad-block-pos="<%= pos %>" ><img src="<%=src %>" alt="<%= alt %>" /></div>',{src:s.imageURL,alt:s.name,pos:i});r+=o}}return r};var c=t.template('<div class="simbaLeader">'+'<div class="smFooter"></div>'+'<div class="smHeader">'+'<div class="nav" simba-position="0">'+'<img src="/adgroups/leader/prev-btn.png" class="prev" /><img src="/adgroups/leader/next-btn.png" class="next" />'+"</div>"+"</div>"+'<div class="smBody">'+'<div class="arrow"></div>'+"<%= bodyImg %>"+'<div class="meta">'+'<div class="meta-inner"><%= metaData %></div>'+"</div>"+'<div class="backProducts"><%= backProducts %></div>'+"</div>"+"</div>",{metaData:f,bodyImg:a,backProducts:l(s,0)});e(n).attr("data-url",o.deepLink);e(n).append(c,null);e(n).find(".meta-inner").click(function(){var t=e(n).attr("data-url");location.href=t});var h=e(".simbaLeader").children().find(".prev, .next");var p=function(){var t=e(this).parent();var n=parseInt(e(t).attr("simba-position"));if(e(this).hasClass("next")){n++;if(n==s.length){n=0}}if(e(this).hasClass("prev")){n--;if(n==-1){n=s.length-1}}var r=s[n];var i=e(this).parent().parent().parent();var o=e(i).parent().find(".simbaAdImage")[0];e(o).attr("src",r.imageURL);e(o).attr("alt",r.name);e(e(i).find(".brand")[0]).text(u.name);e(e(i).find(".description")[0]).text(r.name.truncate(40));e(e(i).find(".price")[0]).text("$"+parseFloat(r.salePrice).currencyFormat(2));e(i).parent().attr("data-url",r.deepLink);e(t).attr("simba-position",n);var a=l(s,n);e(".backProducts > .backProduct").remove();e(".backProducts").append(a,null);e(".simbaLeader > .smBody > .backProducts > .backProduct").click(d)};var d=function(){var t=parseInt(e(this).attr("data-ad-block-pos"));e(".simbaLeader > .smBody > .backProducts > .productContainer").remove();var r=l(s,t);e(".backProducts > .backProduct").remove();e(".backProducts").append(r,null);var i=s[t];var o=e.find(".simbaAdImage")[0];e(o).attr("src",i.imageURL);e(o).attr("alt",i.name);e(".simbaLeader > .smBody > .meta .meta-inner .brand").text(u.name);e(".simbaLeader > .smBody > .meta .meta-inner .description").text(i.name.truncate(40));e(".simbaLeader > .smBody > .meta .meta-inner .price").text("$"+parseFloat(i.salePrice).currencyFormat(2));e(n).attr("data-url",i.deepLink);e(".simbaLeader > .smBody > .backProducts > .backProduct").click(d)};e(".simbaLeader > .smBody > .backProducts > .backProduct").click(d);e(h).click(p)};a()}